import Hideable from '../../../components/Hideable.astro'
import Remarque from '../../../components/Remarque.astro'
import Exercice from '../../../components/Exercice.astro'
import Item from '../../../components/Item.astro'
import Indent from '../../../components/Indent.astro'
import Fil from '../../../components/Fil.astro'


<Item type='proposition' titre='point fixe et limite'>

Soit $f : \R \rightarrow \R$ continue et une suite vérifiant la relation de récurrence $u_{n+1} = f(u_n)\v \forall n \in \N$. Si $\suitedefN{u_n}$ converge vers $l \in \R$, alors $f(l) = l$.
</Item>

<Hideable type='démonstration' titre=''>

On admet que, comme $f$ est continue, $f(u_n) \limton f(l)$, ce que nous démontrerons dans le chapitre sur la continuité.

Comme $u_{n+1} = f(u_n)$, par passage à la limite, $l = f(l)$.
</Hideable>

<Item type='methode' titre='étude des suites récurrentes'>

Soit $f : \R \rightarrow \R$ et une suite vérifiant la relation de récurrence $u_{n+1} = f(u_n)\v \forall n \in \N$.

- L'étude de $g$ permet de déterminer le signe de $u_{n+1} - u_n$ car $u_{n+1} - u_n = f(u_n) - u_n$. Si l'étude de $g$ montre qu'elle est par exemple positive sur $\defff{a}{b}$ __ET__ que $f(\defff{a}{b}) \subset \defff{a}{b}$, alors il est intéressant de montrer (si c'est le cas) que $u_0 \in \defff{a}{b} \Rightarrow \forall n \in \N, u_n \in \defff{a}{b}$, ce qui signifie que $u$ est monotone et que l'on peut conclure par le théorème de la limite monotone. Il en va de même pour le cas décroissant.

$\cd$ La limite éventuelle est trouvée à l'aide du (ou des) point fixe de $f$.

$\cd$ Si l'on n'arrive pas à conclure mais que $f$ est monotone sur $J$ et que $f(J) \subset J$ ($J$ est stable par $f$).

<Indent>

    $\cd$ si $f$ est croissante sur $J$, on montre par récurrence que, si $u_0 \in J$, alors $u$ est monotone.

    $\cd$ si $f$ est décroissante, on considère les suites extraites $u_{2n}$ et $u_{2n+1}$ qui sont toutes deux liées par la relation de récurrence $v_{n+1} = f \circ f (v_n)$ et $f \circ f$ est croissante. On peut donc se ramener au cas précédent à condition que $(u_0 \v u_1) \in J$
</Indent>
</Item>

<Fil>

**Illustration :** Soit la suite $\suitedefN{u_n}$ telle que $u_n = \begin{cases} 0,9 \; \text{ si n = 0} \\ \cos(u_{n-1} + \dfrac{1}{2}) \; \text{ sinon}\end{cases}$. 

<br/>
Voici sa représentation graphique (en rouge les rangs pairs et en gris les rangs impairs):

<img width="500" height="500" class="content-center mx-auto" src = "src/svgs/suite_rec_cas_decroissant.svg" alt="Représentation graphique de u"/>

Ici, un segment stable par $f : x \mapsto \cos(x + \dfrac{1}{2})$ est par exemple $I = \defff{0}{1}$ (ou encore $\defff{}{0,1}{0,9}$). 

Il se trouve que $f$ y est décroissante et on remarque que les suites extraites paires et impaires forment des suites adjacentes. D'où leur étude dans ce cas.

</Fil>

<Exercice titre='études de suites 1'>

Soit $\suitedefN{u_n}$ la suite réelle telle que $u_{n+1} = u_n^2$ et $u_0 \geqslant 0$. Etudier la suite.
</Exercice>

<Hideable type='solution' titre=''>

On pose $f : x \mapsto x^2$ sur $\R$. On a $u_{n+1} = f(u_n)$. On étudie donc $g : x \mapsto f(x) - x$ sur $\R_+$. 

$g'(x) = 2x - 1$ et donc $g'(x) > 0 \ssi x > \dfrac{1}{2}$. On dresse donc le tableau de variation de $g$ :

D'après les variations de $g$, comme $g(0) = 0$, $g(1) = 0$ et $\limm{x \to + \infty} g(x) = + \infty$ et comme $g$ est continue, on a $g(x) \leqslant 0 \, \forall x \in \defff{0}{1}$ et $g(x) \geqslant 0 \v \forall x \in \deffo{1}{+ \infty}$. 

<Indent>

**Cas 1 :** Si $u_0 \in \defff{0}{1}$, on montre par récurrence que $u_n \in \defff{0}{1}$ également pour tout $n \in \N$. (on peut aussi suivre la méthode et montrer que $f(\defff{0}{1}) \subset \defff{0}{1}$ et en déduire que $u_n \in \defff{0}{1}$ pour tout $n$)

**Initialisation :** On vérifie $\cP(0)$ car $1 \leqslant u_0 \leqslant 1$ par hypothèse.

**Hérédité :** Soit $ n \in \N^*$, on suppose $\cP(n)$ vraie. Montrons $\cP(n+1)$.

$u_{n+1} = u_n^2$ mais comme $0 \leqslant u_n \leqslant 1$ par hypothèse de récurrence, on a bien $0 \leqslant u_{n+} \leqslant 1$ par croissance de $x \mapsto x$^sur $\R_+^*$. D'où $u_{n+1} \in \defff{0}{1}$ 

**Conclusion :** On a montré $\cP(0)$ et on a montré que $\cP(n) \Rightarrow \cP(n+1)$ si $ n \in \N$. On a donc bien montré que la propriété est vraie sur $\N^*$


Maintenant, il suffit de remarquer que $g(x) \leqslant 0$ si $x \in \defff{0}{1}$ pour montrer que la suite est décroissante car $u_{n+1} - u_n = g(u_n)$.

La suite est décroissante et minorée donc convergente. Sa limite est notée $l$ est est un point fixe de $f$ d'où $f(l) = l$ et donc $l^2 = l$ et $l \in \{ 0 \v 1\}$. Mais la suite est en faite strictement décroissante sur $\defoo{0}{1}$ car $g$ y est strictement négative. Donc, soit $u_0 = 1$ et dans ce cas $l = 1$, soit $u_0 < 1$ et alors $l = 0$.

**Cas 2 :** Si $u_0 > 1$. La preuve de $\suitedefN{u_n}$ est analogue au cas précédent en montrant que $u_0 > 1 \Rightarrow u_n > 1 \forall n \in \N$ et en concluant à la croissance de la suite. On en déduit que la suite est soit convergente soit elle tend vers $+ \infty$. 

Mais $u_n > u_0 > 1 \v \forall n \in \N$ par croissance de la suite. En passant à la limite et en supposant que la suite est convergente, la limité est strictement supérieure à $1$ ce qui est impossible car les points fixes de $f$ sont $0$ et $1$. La suite tend donc vers $+ \infty$.
</Indent>

</Hideable>

<Exercice titre='études de suites 2 (Mins-Ponts)'>

Soit $\suitedefN{s_n}$ la suite réelle telle que $s_{n+1} = 1 - s_n^2$ et $s_0 = \dfrac{1}{2}$. Etudier la suite.
</Exercice>

<Hideable type='solution' titre=''>

On pose $f : x \mapsto 1-x^2$ sur $\R$. On pose $g : x \mapsto 1 - x^2 - x$ . 

Etudions $g$ pour connaître son signe : On note $\Delta$ le discriminant de $g$. $\Delta = 1 + 4\times 1 = 5$ d'où $g(x) = 0 \ssi x = \dfrac{-1 \pm \sqrt{5}}{2}$. 

$f$ n'est pas stable sur les intervalles où $g$ est de signe constant. 

Comme $f$ est décroissante, on s'intéresse à $u : n \mapsto s_{2n}$ et $v : n \mapsto s_{2n+1}$ sur $\N$. Ces deux suites vérifient la même relation de récurrence : $u_{n+1} = f\circ f(u_n)$ et $v_{n+1} = f\circ f(v_n)$. On peut montrer que si une suite $w$ vérifie cette relation de récurrence, alors elle est monotone de monotonie déterminée par $f(w_0) - w_0$.

On suppose que $0 \leqslant w_0 \leqslant 1$. Montrons sur $\N$ la propriété $\cP(n) : w_{n+1} - w_n$ est de même signe que $w_1 - w_0$ .

**Initialisation :** On vérifie $\cP(0)$. En effet, $w_1 - w_0$ est de même signe que $w_1 - w_0$.

**Hérédité :** Soit $ n \in \N$, on suppose $\cP(n)$ vraie. Montrons $\cP(n+1)$.

Déjà, $f \circ f (x) = 1-(1-x^2)^2 = 1 - 1 + 2x^2 -x^4 = 2x^2 - x^4 \v \forall x\in \R$

$w_{n+2} - w_{n+1} = 2w_{n+1}^2 - w_{n+1}^4 - 2 w_n^2 + w_n^4 = 2(w_{n+1}^2 - w_n^2) - (w_{n+1}^4 - w_n^4)$

$w_{n+2} - w_{n+1} = 2(w_{n+1} - w_n)(w_{n+1} + w_n) - (w_{n+1}^2 - w_n^2)(w_{n+1}^2 + w_n^2) = 2(w_{n+1} - w_n)(w_{n+1} + w_n) - (w_{n+1} - w_n)(w_{n+1} + w_n)(w_{n+1}^2 + w_n^2)$

On factorise : $w_{n+2} - w_{n+1} = (w_{n+1} - w_n)(w_{n+1} + w_n)\Big( 2 - (w_{n+1}^2 + w_n^2) \Big)$. 

En effet, $ 0 \leqslant x \leqslant 1 \Rightarrow  0 \leqslant x^2 \leqslant 1 \Rightarrow 0 \geqslant -x^2 \geqslant -1 \Rightarrow 1 \geqslant 1-x^2 \geqslant 0$. Donc $\defff{0}{1}$ est stable par $f$. Par récurrence immédiate (en utilisant la stabilité de $\deff{0}{1}$ par $f$), $0 \leqslant w_n \leqslant 1\v \forall n \in \N$ d'où $w_{n+1}^2 + w_n^2 \leqslant 2$.

Donc $(w_{n+1} + w_n)\Big( 2 - (w_{n+1}^2 + w_n^2) \Big) \geqslant 0$ et on en conclut que $w_{n+1} + w_n$ et $w_{n+2} - w_{n+1}$ ont même signe. Mais par hytpothèse de récurrence, $w_{n+1} + w_n$ et $w_1 + w_0$ ont même signe. D'où le résultat.


**Conclusion :** On a montré $\cP(0)$ et on a montré que $\cP(n) \Rightarrow \cP(n+1)$ si $ n \in \N$. On a donc bien montré que la propriété est vraie sur $\N$

On remarque en particulier que l'on pouvait conclure au signe strict de $w_{n+1} - w_n$ à condition que $w_0 \in \defoo{0}{1}$.

On a montré que $u$ et $v$ sont monotones. Le calcul des premiers termes montre que $u$ est croissante et que $v$ est décroissante.  Les deux suites ayant la même relation de récurrence, elles ont les mêmes points fixes. Mais elles sont toutes deux monotones et bornées et donc convergentes. 

Mais si $l$ est la limite de $u$, $l = 2l^2 - l^4$ d'où $l^4 - 2l^2 + l = 0$ puis $l(l^3 - 2l + 1) = 0$. On trouve une racine évidente : $1$. D'où $l(l-1)(l^2 -l -1) = 0$ et en calculant le discriminant de $l^2 -l -1 = 0$, on trouve $l(l-1)(l- x_-)(l - x_+) = 0$ où $x_{\pm} = \dfrac{-1 \pm \sqrt{5}}{2}$. Nécessairement, $l \neq x_-$ car $l geqslant 0$. Mais on peut également écarter les cas $0$ et $1$ car on peut montrer par récurrence que $u_0 \leqslant v_n \leqslant v_0 $ et $v_0 \geqslant u_n \geqslant u_0$ sur $\N$ et on en déduit par passage à la limite que aucune de ces deux suites ne peut converger ni vers $0$ ni vers $1$. 

On conclut : $u$ et $v$ sont convergentes vers l'un de leurs points fixes. Mais le seul qui soit possible est $\dfrac{-1 + \sqrt{5}}{2}$. On en déduit que $s_n \limton \dfrac{-1 + \sqrt{5}}{2}$
</Hideable>